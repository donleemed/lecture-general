---
title: "ë©”íƒ€ë¶„ì„"
author: "ê¹€ì§„ì„­"
date: "2026-02-03"
format:
  revealjs: 
    theme: zarathu_theme.scss
    title-slide-attributes:
      data-background-image: bg.png
      data-background-size: cover
      data-background-opacity: "0.3"
    logo: Zarathu Circle Clipping Mask2.png
    footer: "openstat.ai"
    self-contained: false
    chalkboard: 
      buttons: false
    preview-links: true
    show-notes: false
    slide-number: false
    width: 1600
    height: 900
editor: visual
subtitle: "Zarathu Co., Ltd"
---

## ìê¸°ì†Œê°œ

íšŒì‚¬: ì°¨ë¼íˆ¬ (Zarathu Co.,Ltd)

-   R í™œìš© ì˜í•™ì—°êµ¬ì§€ì›
-   R íŒ¨í‚¤ì§€ ê°œë°œ ë° êµìœ¡

ê²½ë ¥

-   ì˜í•™ì‚¬, ì„±ê· ê´€ëŒ€í•™êµ (\~2009)
-   ì˜ˆë°©ì˜í•™ì „ë¬¸ì˜/ë°•ì‚¬ìˆ˜ë£Œ,ì„œìš¸ëŒ€ë³´ê±´ëŒ€í•™ì› (\~2013)
-   ì±…ì„, ì‚¼ì„±ì „ì DMCì—°êµ¬ì†Œ/ë¬´ì„ ì‚¬ì—…ë¶€ (\~2016)
-   ëŒ€í‘œ, ì°¨ë¼íˆ¬ (2018\~)

**jinseob2kim\@gmail.com, github.com/jinseob2kim**

## Executive summary

**ë™ì¼í•œ ê²°ê³¼ì§€í‘œë¥¼ ê°€ì§„ ì—°êµ¬ë“¤ì„ í•©ì¹œë‹¤**

-   Mean, proportion: ê·¸ë£¹ 1ê°œ

-   Ratio(RR, OR, ROM), difference(MD, SMD): ê·¸ë£¹ 2ê°œ ë¹„êµ

-   ê·¸ë£¹ë³„ **Mean(sd) ë˜ëŠ” Event/N ê°’ì´ í•„ìš”**, Measure(95%CI) ë§Œ ìˆì–´ë„ ê°€ëŠ¥.

**Inversed variance: Fixed effect vs Random effect**

-   ë¶„ì‚°ì´ ì‘ì€ ì—°êµ¬ì— ê°€ì¤‘ì¹˜ë¥¼ ì£¼ì§€ë§Œ, í•œ ì—°êµ¬ì˜ ì˜í–¥ë ¥ì´ ë„ˆë¬´ ì»¤ì§€ëŠ”ê±´ ì‹«ë‹¤.

**`Forestplot` ìœ¼ë¡œ í‘œì‹œí•œë‹¤**

-   ê²€ì¦ìœ„í•´ `funnel plot`, heterogeneity ì§€í‘œ í•„ìš”

[openstat.ai](https://openstat.ai) ì—ì„œ ë©”íƒ€ë¶„ì„ ìˆ˜í–‰ ê°€ëŠ¥

-   R [meta](https://doing-meta.guide/) íŒ¨í‚¤ì§€ë¡œë„ êµ¬í˜„ê°€ëŠ¥

## Systematic review

ì‚¬ì‹¤ í¬í•¨í•´ì•¼ í•  ì—°êµ¬ë“¤ì„ ê³ ë¥´ëŠ”ê²Œ ê°€ì¥ ì–´ë µë‹¤.

-   ê°™ì€ ì—°êµ¬ì£¼ì œ

-   ì¸êµ¬ì§‘ë‹¨ì´ ë„ˆë¬´ ì°¨ì´ë‚˜ë©´ ì•ˆë¨(ì„œì–‘ vs ë™ì–‘, ì†Œì•„ vs ë…¸ì¸, ë‚¨ vs ì—¬)

-   ê°™ì€ ê²°ê³¼ì§€í‘œ: Meanê³¼ Median, Ratio ì™€ Differenceë¥¼ í•©ì¹  ìˆœ ì—†ë‹¤.

## PRISMA Flow Diagram

**ì—°êµ¬ ì„ ì • ê³¼ì •ì„ íˆ¬ëª…í•˜ê²Œ ë³´ì—¬ì£¼ëŠ” í‘œì¤€ flowchart**

<br>

```         
Identification   DB ê²€ìƒ‰ (n=1000) + ê¸°íƒ€ (n=50)
                        â†“
                   ì¤‘ë³µ ì œê±° (n=800)
                        â†“
Screening        ì œëª©/ì´ˆë¡ ê²€í†  â†’ ì œì™¸ (n=500)
                        â†“
Eligibility      ì „ë¬¸ ê²€í†  (n=300) â†’ ì œì™¸ (n=250)
                        â†“
Included         ìµœì¢… í¬í•¨ (n=50)
```

<br>

-   ì €ë„ íˆ¬ê³ ì‹œ ê±°ì˜ **í•„ìˆ˜**
-   [PRISMA ê³µì‹ ì‚¬ì´íŠ¸](http://www.prisma-statement.org/)ì—ì„œ í…œí”Œë¦¿ ì œê³µ

## Risk of Bias (ROB)

**í¬í•¨ëœ ì—°êµ¬ë“¤ì˜ ì§ˆ(Quality) í‰ê°€**

| Study | ë¬´ì‘ìœ„ë°°ì • | ë°°ì •ì€ë‹‰ | ëˆˆê°€ë¦¼ | ê²°ì¸¡ | ì„ íƒë³´ê³  |
|-------|:----------:|:--------:|:------:|:----:|:--------:|
| A     |     ğŸŸ¢     |    ğŸŸ¢    |   ğŸŸ¡   |  ğŸŸ¢  |    ğŸŸ¢    |
| B     |     ğŸŸ¢     |    ğŸŸ¡    |   ğŸ”´   |  ğŸŸ¢  |    ğŸŸ¢    |
| C     |     ğŸŸ¢     |    ğŸŸ¢    |   ğŸŸ¢   |  ğŸŸ¡  |    ğŸŸ¢    |
| D     |     ğŸŸ¡     |    ğŸ”´    |   ğŸ”´   |  ğŸŸ¢  |    ğŸŸ¢    |

ğŸŸ¢ Low risk / ğŸŸ¡ Unclear / ğŸ”´ High risk

-   **RCT**: Cochrane ROB 2.0
-   **ê´€ì°°ì—°êµ¬**: Newcastle-Ottawa Scale (NOS)

## Risk of Bias: ì‹¤ì œ ì˜ˆì‹œ

![](example/riskofbias.png){width="80%"}

## ì§€í‘œ ì¢…ë¥˜

1ê·¸ë£¹ ë‹¨ì¼ì§€í‘œ

-   Mean(sd), event/N(%)

-   Medianì€ ë¶ˆê°€ëŠ¥(?) : [ìµœì‹  ë°©ë²•ë¡  í•„ìš”](https://github.com/stmcg/metamedian)

**2ê·¸ë£¹ ë¹„êµ: ëŒ€ë¶€ë¶„**

-   Mean: Difference, ratio

-   event/N(%): Ratio(RR, OR), Difference(RD)

-   ì–´ë–¤ ì§€í‘œë“  Measureê°’ê³¼ S.E(or 95%CI) ê°€ ìˆìœ¼ë©´ ê°€ëŠ¥

## Mean difference (MD)

![](example/md.png)

## MD vs SMD

::: columns
::: {.column width="50%"}
**MD (Mean Difference)**

-   í‰ê·  ì°¨ì´ **ê·¸ëŒ€ë¡œ**
-   **ê°™ì€ ë‹¨ìœ„** ì‚¬ìš©í•  ë•Œ
:::

::: {.column width="50%"}
**SMD (Standardized MD)**

-   í‰ê·  ì°¨ì´ë¥¼ **SDë¡œ ë‚˜ëˆ”**
-   **ë‹¤ë¥¸ ì²™ë„** í•©ì¹  ë•Œ
:::
:::

$$SMD = \frac{\bar{X}_T - \bar{X}_C}{S_{pooled}}$$

| Cohen's d | í•´ì„   |
|-----------|--------|
| 0.2       | Small  |
| 0.5       | Medium |
| 0.8       | Large  |

## Relative risk(Risk ratio)

![](example/RR.png)

## RR, OR, RD: 2x2 í…Œì´ë¸”

|               | Disease+ | Disease- |     |
|---------------|----------|----------|-----|
| **Treatment** | a        | b        | a+b |
| **Control**   | c        | d        | c+d |

::: columns
::: {.column width="33%"}
**RR (Risk Ratio)**

$$\frac{a/(a+b)}{c/(c+d)}$$

ìœ„í—˜ë¥ ì˜ **ë¹„ìœ¨**
:::

::: {.column width="33%"}
**OR (Odds Ratio)**

$$\frac{a/b}{c/d} = \frac{ad}{bc}$$

ì˜¤ì¦ˆì˜ **ë¹„ìœ¨**
:::

::: {.column width="33%"}
**RD (Risk Difference)**

$$\frac{a}{a+b} - \frac{c}{c+d}$$

ìœ„í—˜ë¥ ì˜ **ì°¨ì´**
:::
:::

## RR, OR, RD: ì˜ˆì‹œ

|          | ì‚¬ë§ | ìƒì¡´ |             |
|----------|------|------|-------------|
| **ì‹ ì•½** | 10   | 90   | 100ëª… (10%) |
| **ìœ„ì•½** | 20   | 80   | 100ëª… (20%) |

<br>

-   **RR** = 0.1 / 0.2 = **0.5** â†’ "ì‹ ì•½ ì“°ë©´ ì‚¬ë§ìœ„í—˜ **ì ˆë°˜**"

-   **OR** = (10Ã—80) / (90Ã—20) = **0.44** â†’ RRê³¼ ë¹„ìŠ· (í¬ê·€ì§ˆí™˜ì¼ìˆ˜ë¡ ìœ ì‚¬)

-   **RD** = 0.1 - 0.2 = **-0.1** â†’ "**10%p** ì‚¬ë§ ê°ì†Œ", NNT = 10

## RR, OR, RD: ì–¸ì œ ì“°ë‚˜?

| ì§€í‘œ   | ì¥ì                                 | ì£¼ ì‚¬ìš©ì²˜                   |
|--------|-------------------------------------|-----------------------------|
| **RR** | ê°€ì¥ ì§ê´€ì  ("ëª‡ ë°°")               | RCT, ì½”í˜¸íŠ¸                 |
| **OR** | Case-controlì—ì„œ ìœ ì¼í•˜ê²Œ ê³„ì‚° ê°€ëŠ¥ | Case-control, ë¡œì§€ìŠ¤í‹± íšŒê·€ |
| **RD** | ì ˆëŒ€ íš¨ê³¼í¬ê¸°, NNT ê³„ì‚°             | ì„ìƒì  ì˜ì‚¬ê²°ì •             |

<br>

::: callout-note
í¬ê·€ ì§ˆí™˜(ë°œìƒë¥  \< 10%)ì—ì„œëŠ” **OR â‰ˆ RR**
:::

## Case-control ì—°êµ¬ë€?

**ì½”í˜¸íŠ¸**: ë…¸ì¶œêµ°/ë¹„ë…¸ì¶œêµ° ëª¨ì•„ì„œ â†’ ì§ˆë³‘ ë°œìƒ **ì¶”ì **

**Case-control**: ì§ˆë³‘O(case)/ì§ˆë³‘X(control) ëª¨ì•„ì„œ â†’ ê³¼ê±° ë…¸ì¶œ **ì¡°ì‚¬**

<br>

::: columns
::: {.column width="50%"}
**ì½”í˜¸íŠ¸** (ì „í–¥ì )

```         
í¡ì—°ì 1000ëª…   â†’  íì•” 50ëª…
ë¹„í¡ì—°ì 1000ëª… â†’  íì•” 5ëª…
```

ë°œìƒë¥  ê³„ì‚° ê°€ëŠ¥!
:::

::: {.column width="50%"}
**Case-control** (í›„í–¥ì )

```         
íì•” 100ëª…   â† í¡ì—° 80ëª…
ì •ìƒ 100ëª…  â† í¡ì—° 20ëª…
```

case:control ë¹„ìœ¨ì€ **ì—°êµ¬ì ë§˜ëŒ€ë¡œ**
:::
:::

## Case-controlì—ì„œ ì™œ RR ì•ˆë¨?

|            | íì•” | ì •ìƒ |     |
|------------|------|------|-----|
| **í¡ì—°**   | 80   | 20   | 100 |
| **ë¹„í¡ì—°** | 20   | 80   | 100 |

-   **RR** = (80/100) / (20/100) = 4? âŒ

-   100ëª…, 100ëª…ì€ **ì—°êµ¬ìê°€ ì •í•œ ìˆ«ì**ì¼ ë¿, ì‹¤ì œ í¡ì—°ì/ë¹„í¡ì—°ì ìˆ˜ê°€ ì•„ë‹˜!

-   $$\text{OR} = \frac{a/b}{c/d} = \frac{a/c}{b/d} = \frac{ad}{bc} = 16 $$

-   $\frac{a/b}{c/d}$: ë…¸ì¶œêµ° ì˜¤ì¦ˆ / ë¹„ë…¸ì¶œêµ° ì˜¤ì¦ˆ â†’ **ì½”í˜¸íŠ¸ ê´€ì **

-   $\frac{a/c}{b/d}$: case ë…¸ì¶œë¥  / control ë…¸ì¶œë¥  â†’ **case-control ê´€ì **

-   ë‘˜ ë‹¤ **ad/bc** â†’ ORì€ ì½”í˜¸íŠ¸, case-control **ë‘˜ ë‹¤ ì‚¬ìš© ê°€ëŠ¥!**

## Event/N ì—†ë‹¤ë©´?

-   ì–´ë–¤ ì§€í‘œë“  ê·¸ ì¶”ì •ê°’ê³¼ 95%CI(ë˜ëŠ” standard error) ë§Œ ìˆìœ¼ë©´ ë¨.

```{r}
library(jskm);library(survival)
cc <- survfit(Surv(time, status) ~ sex, data = colon)
jskm(cc, table = T, hr = T, marks = F, hr.coord = c(1000, 0.2), timeby = 365, ystratalabs = c("Female", "Male"), ystrataname = "Sex")
```

## HR(Hazard ratio)

![](example/hr.png)

## ë©”íƒ€ë¶„ì„ ê³„ì‚°: Fixed Effect Model

**ê°œë³„ ì—°êµ¬ë¥¼ ê°€ì¤‘ í‰ê· **ìœ¼ë¡œ í•©ì¹œë‹¤

$$\hat{\theta}_{pooled} = \frac{\sum w_i \hat{\theta}_i}{\sum w_i}$$

-   $\hat{\theta}_i$: ê° ì—°êµ¬ì˜ ì¶”ì •ê°’ (MD, log OR, log RR ë“±)
-   $w_i$: ê°€ì¤‘ì¹˜ (ì •ë°€í•œ ì—°êµ¬ì— í° ê°€ì¤‘ì¹˜)

<br>

**ê°€ì¤‘ì¹˜ ê³„ì‚° ë°©ë²•ì´ 2ê°€ì§€**

| ë°ì´í„°      | ë°©ë²•                      | ê°€ì¤‘ì¹˜           |
|-------------|---------------------------|------------------|
| Mean(sd), N | **IV** (Inverse Variance) | $w_i = 1/Var_i$  |
| 2Ã—2 í…Œì´ë¸”  | **MH** (Mantel-Haenszel)  | í…Œì´ë¸” ê¸°ë°˜ ê³µì‹ |

## IV (Inverse Variance) ë°©ë²•

**ë¶„ì‚°ì˜ ì—­ìˆ˜ = ê°€ì¤‘ì¹˜**

$$w_i = \frac{1}{Var(\hat{\theta}_i)}$$

-   ë¶„ì‚° ì‘ì€(ì •ë°€í•œ) ì—°êµ¬ â†’ ê°€ì¤‘ì¹˜ í¼
-   **ì—°ì†í˜•**(MD, SMD)ì—ì„œ ê¸°ë³¸ ì‚¬ìš©
-   ë²”ìš©ì : ì¶”ì •ê°’ + SEë§Œ ìˆìœ¼ë©´ ë‹¤ ê°€ëŠ¥

<br>

**Mean difference ì˜ˆì‹œ**

$$Var(MD) = \frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}$$

## MH (Mantel-Haenszel) ë°©ë²•

**2Ã—2 í…Œì´ë¸” ì§ì ‘ ì´ìš©** (log ë³€í™˜ ì—†ì´)

|           | Event | No Event |     |
|-----------|-------|----------|-----|
| Treatment | a     | b        | n1  |
| Control   | c     | d        | n2  |

<br>

**ORì˜ MH ê°€ì¤‘ì¹˜**

$$w_i = \frac{b_i c_i}{n_{1i} + n_{2i}}$$

-   ì´ë²¤íŠ¸ ì ì€ sparse dataì— robust
-   **ì´ë¶„í˜•**(RR, OR, RD) ê¸°ë³¸ ë°©ë²•

## 2Ã—2 í…Œì´ë¸”ë„ IVë¡œ ê°€ëŠ¥

**log ë³€í™˜í•˜ë©´ IV ì‚¬ìš© ê°€ëŠ¥!**

$$\log(OR) = \log\left(\frac{ad}{bc}\right)$$

$$Var(\log OR) = \frac{1}{a} + \frac{1}{b} + \frac{1}{c} + \frac{1}{d}$$

<br>

| ë°©ë²•   | ì¥ì                          | ë‹¨ì                          |
|--------|------------------------------|------------------------------|
| **MH** | sparse dataì— ê°•í•¨, ì§ê´€ì    | 2Ã—2 í…Œì´ë¸” í•„ìš”, **Fixedë§Œ** |
| **IV** | ë²”ìš©ì , Fixed + Random ë‘˜ ë‹¤ | 0ì…€ ìˆìœ¼ë©´ ë³´ì • í•„ìš”         |

::: callout-tip
**Random effectëŠ” IV ê¸°ë°˜** (Ï„Â² ì¶”ì •ì´ IV ê¸°ë°˜ì´ë¼ì„œ)
:::

## Fixed Effectì˜ ë¬¸ì œì 

**ê°€ì •: ëª¨ë“  ì—°êµ¬ì˜ true effectê°€ ë™ì¼í•˜ë‹¤**

$$\theta_1 = \theta_2 = \cdots = \theta_k = \theta$$

<br>

**ë¬¸ì œ: SE ì‘ì€ ì—°êµ¬ê°€ ê°€ì¤‘ì¹˜ ë…ì‹**

| ì—°êµ¬        | íš¨ê³¼ | SE   | ê°€ì¤‘ì¹˜ (1/Var) |
|-------------|------|------|----------------|
| A (n=10000) | 0.8  | 0.05 | **400**        |
| B (n=100)   | 1.5  | 0.5  | 4              |
| C (n=100)   | 1.3  | 0.5  | 4              |

â†’ ì—°êµ¬ Aê°€ ê²°ê³¼ì˜ 98%ë¥¼ ê²°ì •!

## Random Effect Model

**ê°€ì •: ê° ì—°êµ¬ì˜ true effectê°€ ë‹¤ë¥¼ ìˆ˜ ìˆë‹¤**

$$\theta_i \sim N(\mu, \tau^2)$$

-   $\mu$: ì „ì²´ í‰ê·  íš¨ê³¼
-   $\tau^2$: **ì—°êµ¬ ê°„ ë¶„ì‚°** (between-study variance)

<br>

**ê°€ì¤‘ì¹˜ì— Ï„Â² ì¶”ê°€**

$$w_i^{RE} = \frac{1}{Var_i + \tau^2}$$

â†’ í° ì—°êµ¬ì˜ ê°€ì¤‘ì¹˜ ë…ì‹ ì™„í™”!

## Fixed vs Random ë¹„êµ

|             | Fixed                      | Random                |
|-------------|----------------------------|-----------------------|
| **ê°€ì •**    | ëª¨ë“  ì—°êµ¬ true effect ë™ì¼ | ì—°êµ¬ë§ˆë‹¤ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ |
| **ê°€ì¤‘ì¹˜**  | $1/Var_i$                  | $1/(Var_i + \tau^2)$  |
| **í° ì—°êµ¬** | ê°€ì¤‘ì¹˜ ë…ì‹ ê°€ëŠ¥           | ì™„í™”ë¨                |
| **ì¼ë°˜í™”**  | í¬í•¨ëœ ì—°êµ¬ì—ë§Œ            | ë” ë„“ì€ ëª¨ì§‘ë‹¨ì—      |

<br>

::: callout-important
**í˜„ì¬ ì¶”ì„¸: Random effectë¥¼ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©**

ì—°êµ¬ë“¤ì´ ì™„ì „íˆ ë™ì¼í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ ë³´ìˆ˜ì ì¸ Random ì„ í˜¸
:::

## Heterogeneity ì§€í‘œ

**ì—°êµ¬ë“¤ì´ ì–¼ë§ˆë‚˜ ë‹¤ë¥¸ê°€?**

<br>

**1. Q statistic (Cochran's Q)**

$$Q = \sum w_i (\hat{\theta}_i - \hat{\theta}_{pooled})^2$$

-   ì¹´ì´ì œê³± ë¶„í¬, df = k-1
-   p \< 0.05 â†’ ì´ì§ˆì„± ìˆìŒ (but ê²€ì •ë ¥ ë‚®ìŒ)

<br>

**2. IÂ² (ê°€ì¥ ë§ì´ ì”€)**

$$I^2 = \frac{Q - (k-1)}{Q} \times 100\%$$

-   ì „ì²´ ë³€ë™ ì¤‘ **ì—°êµ¬ ê°„ ì°¨ì´**ê°€ ì°¨ì§€í•˜ëŠ” ë¹„ìœ¨

## IÂ² í•´ì„

| IÂ²      | ì´ì§ˆì„± ì •ë„              |
|---------|--------------------------|
| 0-25%   | ë‚®ìŒ (Low)               |
| 25-50%  | ì¤‘ê°„ (Moderate)          |
| 50-75%  | ë†’ìŒ (Substantial)       |
| 75-100% | ë§¤ìš° ë†’ìŒ (Considerable) |

<br>

**3. Ï„Â² (tau-squared)**

-   ì—°êµ¬ ê°„ ë¶„ì‚°ì˜ **ì ˆëŒ€ê°’**
-   IÂ²ëŠ” ë¹„ìœ¨, Ï„Â²ëŠ” ì‹¤ì œ í¬ê¸°

::: callout-note
IÂ² ë†’ìœ¼ë©´ â†’ subgroup ë¶„ì„, meta-regression ê³ ë ¤
:::

## R ê²°ê³¼ í™”ë©´

``` r
Number of studies: k = 5
Number of observations: o = 1046 (o.e = 532, o.c = 514)
Number of events: e = 227

                         OR           95%-CI     z p-value
Common effect model  0.7066 [0.5260; 0.9491] -2.31  0.0211
Random effects model 0.7417 [0.4609; 1.1936] -1.23  0.2183

Quantifying heterogeneity (with 95%-CIs):
 tau^2 = 0.0888 [0.0000; 4.5875]; tau = 0.2981 [0.0000; 2.1418]
 I^2 = 30.8% [0.0%; 73.4%]; H = 1.20 [1.00; 1.94]

Test of heterogeneity:
    Q d.f. p-value
 5.78    4  0.2159

Details of meta-analysis methods:
- Mantel-Haenszel method (common effect model)
- Inverse variance method (random effects model)
- Restricted maximum-likelihood estimator for tau^2
- Q-Profile method for confidence interval of tau^2 and tau
- Calculation of I^2 based on Q
```

## Forestplot

![](example/subgroup.png){width="85%"}

## Forestplot í•´ì„

**ë©”íƒ€ë¶„ì„ì˜ ëŒ€í‘œ ì‹œê°í™”**

-   ê° ì—°êµ¬: **ì **(íš¨ê³¼ í¬ê¸°) + **ì„ **(95% CI)
-   **ì  í¬ê¸°** = ê°€ì¤‘ì¹˜ (í´ìˆ˜ë¡ ì˜í–¥ë ¥ í¼)
-   **ë‹¤ì´ì•„ëª¬ë“œ** = pooled estimate (í­ = 95% CI)
-   **ì„¸ë¡œì„ ** = null effect (OR=1, RR=1, MD=0)

<br>

::: callout-tip
ë‹¤ì´ì•„ëª¬ë“œê°€ ì„¸ë¡œì„ ê³¼ ì•ˆ ê²¹ì¹˜ë©´ â†’ í†µê³„ì ìœ¼ë¡œ ìœ ì˜
:::

## Funnel plot

![](example/funnel.png){width="70%"}

## Funnel plot í•´ì„

**Publication bias í™•ì¸ìš©**

-   **Xì¶•**: íš¨ê³¼ í¬ê¸° (OR, RR ë“±)
-   **Yì¶•**: SE (ìœ„ë¡œ ê°ˆìˆ˜ë¡ ì •ë°€í•œ ì—°êµ¬)

<br>

| ëª¨ì–‘          | í•´ì„                  |
|---------------|-----------------------|
| âœ… **ëŒ€ì¹­**   | bias ì—†ìŒ             |
| âŒ **ë¹„ëŒ€ì¹­** | publication bias ì˜ì‹¬ |

â†’ ìœ ì˜í•˜ì§€ ì•Šì€ ì‘ì€ ì—°êµ¬ê°€ ì¶œíŒ ì•ˆ ë¼ì„œ í•œìª½ì´ ë¹„ëŠ” í˜„ìƒ

<br>

**í†µê³„ ê²€ì •**: Egger's test, Begg's test (ì—°êµ¬ \< 10ê°œë©´ ê²€ì •ë ¥ ë¶€ì¡±)

## Drapery plot (í•„ìˆ˜ëŠ” ì•„ë‹˜)

![](example/drapery.png){width="75%"}

-   ê° ì—°êµ¬ì˜ **p-value function**ì„ ì—°ì†ì ìœ¼ë¡œ í‘œì‹œ
-   0.05ì—ë§Œ ì§‘ì°©í•˜ì§€ ì•Šê³  ë‹¤ì–‘í•œ Î±ì—ì„œ í•´ì„ ê°€ëŠ¥

## ì‹¬í™”: Egger's test

**Funnel plot ë¹„ëŒ€ì¹­ì˜ í†µê³„ ê²€ì •**

$$\frac{\hat{\theta}_i}{SE_i} = \beta_0 + \beta_1 \cdot \frac{1}{SE_i}$$

-   íš¨ê³¼í¬ê¸°ë¥¼ SEë¡œ ë‚˜ëˆˆ ê°’(standardized effect)ì„ 1/SEì— íšŒê·€
-   **Hâ‚€**: $\beta_0 = 0$ (ì ˆí¸ = 0ì´ë©´ ëŒ€ì¹­)
-   p \< 0.05 â†’ funnel plot ë¹„ëŒ€ì¹­ â†’ publication bias ì˜ì‹¬

<br>

::: callout-warning
**í•œê³„**: ì—°êµ¬ ìˆ˜ \< 10ê°œë©´ ê²€ì •ë ¥ ë¶€ì¡±, ì´ì§ˆì„± ë†’ìœ¼ë©´ ìœ„ì–‘ì„±
:::

## ì‹¬í™”: Trim & Fill method

**Publication bias ë³´ì • ë°©ë²•**

::: columns
::: {.column width="50%"}
**Step 1: Trim**

-   ë¹„ëŒ€ì¹­ ìœ ë°œí•˜ëŠ” ì—°êµ¬ë“¤ ì œê±°
-   ëŒ€ì¹­ì´ ë  ë•Œê¹Œì§€ ë°˜ë³µ

**Step 2: Fill**

-   ì œê±°í•œ ì—°êµ¬ì˜ "ê±°ìš¸ìƒ" ê°€ìƒ ì—°êµ¬ ì¶”ê°€
-   ëŒ€ì¹­ì ì¸ funnel plot ì™„ì„±
:::

::: {.column width="50%"}
```         
     Before          After (Fill)
       â—                 â—
      â— â—               â— â—
     â—   â—             â—   â—
    â—     â—    â†’      â—  â—  â—
   â—                  â— â—   â—
                        â—
   (ë¹„ëŒ€ì¹­)            (ëŒ€ì¹­ + ê°€ìƒì—°êµ¬)
```
:::
:::

<br>

**ë³´ì •ëœ pooled estimate** ì œì‹œ â†’ ì›ë˜ ê²°ê³¼ì™€ ë¹„êµ

## ì‹¬í™”: ì´ë²ˆ ê°•ì˜ì—ì„œ ì œì™¸

**Meta-regression**

-   IÂ² ë†’ì„ ë•Œ: ì´ì§ˆì„±ì˜ **ì›ì¸**ì„ ì°¾ê³  ì‹¶ë‹¤
-   ì—°êµ¬ íŠ¹ì„±(ì¶œíŒë…„ë„, í‰ê· ë‚˜ì´, ìš©ëŸ‰ ë“±)ì„ **ê³µë³€ëŸ‰**ìœ¼ë¡œ íšŒê·€ë¶„ì„
-   ì˜ˆ: "ì¶œíŒë…„ë„ê°€ ìµœê·¼ì¼ìˆ˜ë¡ íš¨ê³¼ê°€ ì‘ì•„ì§€ëŠ”ê°€?"

<br>

**Network Meta-analysis (NMA)**

-   A vs B, B vs C ì—°êµ¬ëŠ” ìˆëŠ”ë° A vs CëŠ” ì—†ë‹¤?
-   **ê°„ì ‘ ë¹„êµ**ë¡œ A vs C ì¶”ì • ê°€ëŠ¥
-   ì—¬ëŸ¬ ì¹˜ë£Œë²•ì„ **ìˆœìœ„**ë¡œ ë¹„êµ (SUCRA)

```         
    A â”€â”€â”€ B
     \   /
      \ /
       C
```

## ì‹¤ìŠµ: openstat.ai

![](example/openstat.png)

## ì‹¤ìŠµ: R

**Rì—ì„œ ë©”íƒ€ë¶„ì„ì„ í•˜ê¸° ìœ„í•´ì„œëŠ” meta íŒ¨í‚¤ì§€ í•„ìš”**

ë‹¤ìŒ ì½”ë“œë¥¼ í†µí•´ metaíŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•´ë´…ì‹œë‹¤.

```{r}
#| echo: true
#| eval: false 

install.packages('meta')
library(meta)
```

## ì‹¤ìŠµ: meta íŒ¨í‚¤ì§€ì˜ ê¸°ëŠ¥(1)

**meta íŒ¨í‚¤ì§€ ë‚´ì˜ ê°ì¢… method ì†Œê°œ**

ì—°ì†í˜• ìë£Œì˜ ë©”íƒ€ë¶„ì„ -\> metacont

ì´ì§„í˜• ìë£Œì˜ ë©”íƒ€ë¶„ì„ -\> metabin

ë©”íƒ€ë¶„ì„ì—ì„œ IV ë°©ë²• ì‚¬ìš©í•  ë•Œ -\> metagen

## ì‹¤ìŠµ: meta íŒ¨í‚¤ì§€ì˜ ê¸°ëŠ¥(2)

**meta íŒ¨í‚¤ì§€ ë‚´ì˜ ê°ì¢… method ì†Œê°œ**

ìƒê´€ê´€ê³„ì— ëŒ€í•œ ë©”íƒ€ë¶„ì„ -\> metacor

í‰ê· ì— ëŒ€í•œ ë©”íƒ€ë¶„ì„ -\> metamean

ë¹„ìœ¨ì— ëŒ€í•œ ë©”íƒ€ë¶„ì„ -\> metaprop

ë°œìƒë¥ ì— ëŒ€í•œ ë©”íƒ€ë¶„ì„ -\> metarate

## ì‹¤ìŠµ: meta íŒ¨í‚¤ì§€ì˜ ê¸°ëŠ¥(3)

**meta íŒ¨í‚¤ì§€ ë‚´ì˜ ê°ì¢… method ì†Œê°œ-plot**

Forest plot -\> forest.meta, forest.metabind

Funnel plot -\> funnel.meta

Drapery plot -\> drapery

## ì˜ˆì œ ë°ì´í„° ì†Œê°œ: woodyplants

**meta íŒ¨í‚¤ì§€ì˜ ë‚´ì¥ ë°ì´í„°**

-   **ì£¼ì œ:** ëŒ€ê¸° ì¤‘ CO2â€‹ ë†ë„ ì¦ê°€ê°€ ëª©ë³¸ì‹ë¬¼(Woody Plants)ì˜ ì„±ì¥ì— ë¯¸ì¹˜ëŠ” ì˜í–¥

-   **ë³€ìˆ˜:** ë°”ì´ì˜¤ë§¤ìŠ¤(Biomass, ë¬´ê²Œ)

-   **ì‹¤í—˜êµ°(Experimental)** : CO2â€‹ ë†ë„ ë†’ìŒ

-   **ëŒ€ì¡°êµ°(Control)**: ì¼ë°˜ ëŒ€ê¸° ìƒíƒœ

**íŠ¹ì´ì‚¬í•­:** ë‹¤ì–‘í•œ ì¢…(Species)ì´ ì„ì—¬ ìˆìŒ-\>**ì‹ë¬¼ë“¤ì˜ scaleì°¨ì´ê°€ ì¡´ì¬**

## ì˜ˆì œ ë°ì´í„° ì†Œê°œ: woodyplants

```{r}
library(meta)
library(ggplot2)

data(woodyplants, package = "meta")

plot(woodyplants$mean.amb, woodyplants$mean.elev, 
     main = "Check Scales",     # ì œëª©
     xlab = "Control Mean", ylab = "Experimental Mean", 
     pch = 19, col = "blue")    # ì  ëª¨ì–‘, ìƒ‰ìƒ
```

## Scale ì°¨ì´ë¥¼ ê³ ë ¤í•˜ì§€ ì•Šì•˜ì„ ë•Œ-MD

```{r}
#| output-location: slide
#| fig-width: 12
#| fig-height: 7
#| fig-class: r-stretch
#| out-width: "100%"
library(meta)
data(woodyplants)

# 1. ì‹¤íŒ¨í•œ ì‹œê°í™” (MD) 
m_md <- metacont(n.e = n.elev, mean.e = mean.elev, sd.e = sd.elev,
                 n.c = n.amb, mean.c = mean.amb, sd.c = sd.amb,
                 data = woodyplants, sm = "MD", subset = 1:20) # ë„ˆë¬´ ë§ìœ¼ë©´ 20ê°œë§Œ
forest(m_md, 
       main = "Before: ë‹¨ìœ„ê°€ ì œê°ê° (MD)", 
       digits = 1, 
       xlim = c(-100, 100))


```

## Scale ì°¨ì´ë¥¼ ê³ ë ¤í•  ë•Œ - SMD

```{r}
#| output-location: slide
#| fig-width: 12
#| fig-height: 7
#| fig-class: r-stretch
#| out-width: "100%"
m_smd <- metacont(n.e = n.elev, mean.e = mean.elev, sd.e = sd.elev,
                  n.c = n.amb, mean.c = mean.amb, sd.c = sd.amb,
                  data = woodyplants, sm = "SMD", subset = 1:20)
forest(m_smd, 
       main = "After: í‘œì¤€í™” ì™„ë£Œ (SMD)", digits = 2)
```

## R ì‹¤ìŠµ ì˜ˆì œ - Forest plot ì˜µì…˜ ë³€í™” (1)

### ê¸°ë³¸ ì¶œë ¥

ì•„ë¬´ ì˜µì…˜ ì—†ì´ ê¸°ë³¸ forest plotì„ ì¶œë ¥í•´ë´…ì‹œë‹¤.

```{r}
#| echo: true
#| eval: false
forest(m_smd)
```

-   ê³ ì •íš¨ê³¼(Common effect)ì™€ ëœë¤íš¨ê³¼(Random effects) ëª¨ë‘ í‘œì‹œ

-   ê¸°ë³¸ ë ˆì´ì•„ì›ƒ ì ìš©

-   ëª¨ë“  ì—´ì´ ê¸°ë³¸ê°’ìœ¼ë¡œ í‘œì‹œ

------------------------------------------------------------------------

## R ì‹¤ìŠµ ì˜ˆì œ - Forest plot ì˜µì…˜ ë³€í™” (1)

### ê¸°ë³¸ ì¶œë ¥

![](images/clipboard-1030888938.png){fig-align="center" width="100%"}

## R ì‹¤ìŠµ ì˜ˆì œ - Forest plot ì˜µì…˜ ë³€í™” (2)

### layout ë³€ê²½

`layout` ì˜µì…˜ìœ¼ë¡œ ì „ì²´ì ì¸ ìŠ¤íƒ€ì¼ì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```{r}
#| echo: true
#| eval: false
forest(m_smd,
       layout = "JAMA")
```

| layout ê°’   | ì„¤ëª…                           |
|-------------|--------------------------------|
| `"meta"`    | ê¸°ë³¸ ìŠ¤íƒ€ì¼                    |
| `"JAMA"`    | JAMA ì €ë„ ìŠ¤íƒ€ì¼               |
| `"RevMan5"` | Cochrane Review Manager ìŠ¤íƒ€ì¼ |
| `"BMJ"`     | BMJ ì €ë„ ìŠ¤íƒ€ì¼                |

------------------------------------------------------------------------

## R ì‹¤ìŠµ ì˜ˆì œ - Forest plot ì˜µì…˜ ë³€í™” (2)

### layout ë³€ê²½

![](images/clipboard-3736888677.png){fig-align="center" width="100%"}

## R ì‹¤ìŠµ ì˜ˆì œ - Forest plot ì˜µì…˜ ë³€í™” (3)

### ê³ ì •íš¨ê³¼ ëª¨ë¸ ìˆ¨ê¸°ê¸°

`common = FALSE`ë¡œ ê³ ì •íš¨ê³¼ ëª¨ë¸ì„ ìˆ¨ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```{r}
#| echo: true
#| eval: false
forest(m_smd,
       common = FALSE)
```

| ì˜µì…˜              | ì„¤ëª…                |
|-------------------|---------------------|
| `common = FALSE`  | ê³ ì •íš¨ê³¼ ëª¨ë¸ ìˆ¨ê¹€  |
| `random = FALSE`  | ëœë¤íš¨ê³¼ ëª¨ë¸ ìˆ¨ê¹€  |
| `overall = FALSE` | ì „ì²´ ìš”ì•½ íš¨ê³¼ ìˆ¨ê¹€ |

> **ì°¸ê³ **: êµ¬ë²„ì „ì—ì„œëŠ” `comb.fixed`, `comb.random` ì‚¬ìš©

------------------------------------------------------------------------

## R ì‹¤ìŠµ ì˜ˆì œ - Forest plot ì˜µì…˜ ë³€í™” (3)

### ê³ ì •íš¨ê³¼ ëª¨ë¸ ìˆ¨ê¸°ê¸°

![](images/clipboard-1138380893.png){fig-align="center" width="100%"}

## R ì‹¤ìŠµ ì˜ˆì œ - Forest plot ì˜µì…˜ ë³€í™” (4)

### ë¼ë²¨ í…ìŠ¤íŠ¸ ë³€ê²½

ìš”ì•½ íš¨ê³¼ì˜ ë¼ë²¨ì„ ì›í•˜ëŠ” í…ìŠ¤íŠ¸ë¡œ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```{r}
#| echo: true
#| eval: false
forest(m_smd,
       common = FALSE,
       text.random = "Overall Effect")
```

| ì˜µì…˜           | ì„¤ëª…          |
|----------------|---------------|
| `text.random`  | ëœë¤íš¨ê³¼ ë¼ë²¨ |
| `text.common`  | ê³ ì •íš¨ê³¼ ë¼ë²¨ |
| `text.predict` | ì˜ˆì¸¡êµ¬ê°„ ë¼ë²¨ |

------------------------------------------------------------------------

## R ì‹¤ìŠµ ì˜ˆì œ - Forest plot ì˜µì…˜ ë³€í™” (4)

### ë¼ë²¨ í…ìŠ¤íŠ¸ ë³€ê²½

![](images/clipboard-2213654197.png){fig-align="center" width="100%"}

## R ì‹¤ìŠµ ì˜ˆì œ - Forest plot ì˜µì…˜ ë³€í™” (5)

### ì˜ˆì¸¡êµ¬ê°„(Prediction Interval) ì¶”ê°€

`prediction = TRUE`ë¡œ ì˜ˆì¸¡êµ¬ê°„ì„ í‘œì‹œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```{r}
#| echo: true
#| eval: false
forest(m_smd,
       common = FALSE,
       text.random = "Overall Effect",
       prediction = TRUE)
```

-   **ì‹ ë¢°êµ¬ê°„(CI)**: ëª¨ì§‘ë‹¨ í‰ê·  íš¨ê³¼ì˜ ë¶ˆí™•ì‹¤ì„±
-   **ì˜ˆì¸¡êµ¬ê°„(PI)**: í–¥í›„ ê°œë³„ ì—°êµ¬ íš¨ê³¼ê°€ ë‚˜íƒ€ë‚  ë²”ìœ„

------------------------------------------------------------------------

## R ì‹¤ìŠµ ì˜ˆì œ - Forest plot ì˜µì…˜ ë³€í™” (5)

### ì˜ˆì¸¡êµ¬ê°„(Prediction Interval) ì¶”ê°€

![](images/clipboard-2213654197.png){fig-align="center" width="100%"}

## R ì‹¤ìŠµ ì˜ˆì œ - Forest plot ì˜µì…˜ ë³€í™” (6)

### xì¶• ë²”ìœ„ ë° ëˆˆê¸ˆ ì¡°ì •

`xlim`ê³¼ `at`ìœ¼ë¡œ xì¶•ì„ ì¡°ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```{r}
#| echo: true
#| eval: false
forest(m_smd,
       common = FALSE,
       text.random = "Overall Effect",
       prediction = TRUE,
       xlim = c(-2, 2),
       at = c(-2, -1, 0, 1, 2))
```

| ì˜µì…˜   | ì„¤ëª…        | ì˜ˆì‹œ                   |
|--------|-------------|------------------------|
| `xlim` | xì¶• ë²”ìœ„    | `c(-2, 2)`             |
| `at`   | ëˆˆê¸ˆ ìœ„ì¹˜   | `c(-2, -1, 0, 1, 2)`   |
| `ref`  | ê¸°ì¤€ì„  ìœ„ì¹˜ | `0` (SMD), `1` (OR/RR) |

------------------------------------------------------------------------

## R ì‹¤ìŠµ ì˜ˆì œ - Forest plot ì˜µì…˜ ë³€í™” (6)

### xì¶• ë²”ìœ„ ë° ëˆˆê¸ˆ ì¡°ì •

![](images/clipboard-1135664590.png){fig-align="center" width="100%"}

## R ì‹¤ìŠµ ì˜ˆì œ - Forest plot ì˜µì…˜ ë³€í™” (7)

### ì¶• ë¼ë²¨ ì¶”ê°€

`label.left`, `label.right`ë¡œ ë°©í–¥ì„±ì„ ëª…ì‹œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```{r}
#| echo: true
#| eval: false
forest(m_smd,
       common = FALSE,
       text.random = "Overall Effect",
       prediction = TRUE,
       xlim = c(-2, 2),
       at = c(-2, -1, 0, 1, 2),
       label.left = "Favours Control",
       label.right = "Favours CO2")
```

-   ê¸°ì¤€ì„  ì™¼ìª½/ì˜¤ë¥¸ìª½ì´ ë¬´ì—‡ì„ ì˜ë¯¸í•˜ëŠ”ì§€ ëª…í™•íˆ í‘œì‹œ
-   ë…ìê°€ ê²°ê³¼ë¥¼ í•´ì„í•˜ê¸° ì‰¬ì›Œì§

------------------------------------------------------------------------

## R ì‹¤ìŠµ ì˜ˆì œ - Forest plot ì˜µì…˜ ë³€í™” (7)

### ì¶• ë¼ë²¨ ì¶”ê°€

![](images/clipboard-3016209676.png){fig-align="center" width="100%"}

## R ì‹¤ìŠµ ì˜ˆì œ - Forest plot ì˜µì…˜ ë³€í™” (8)

### ì´ì§ˆì„± í†µê³„ëŸ‰ í‘œì‹œ ì¡°ì •

ì´ì§ˆì„± ê´€ë ¨ í†µê³„ëŸ‰ í‘œì‹œë¥¼ ì„¸ë¶€ ì¡°ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```{r}
#| echo: true
#| eval: false
forest(m_smd,
       common = FALSE,
       text.random = "Overall Effect",
       prediction = TRUE,
       xlim = c(-2, 2),
       at = c(-2, -1, 0, 1, 2),
       label.left = "Favours Control",
       label.right = "Favours CO2",
       digits = 2,
       digits.pval = 3,
       print.I2 = FALSE,
       print.tau2 = FALSE,
       print.pval.Q = FALSE)
```

| ì˜µì…˜           | í‘œì‹œ ë‚´ìš©                   |
|----------------|-----------------------------|
| `print.I2`     | IÂ² í†µê³„ëŸ‰                   |
| `print.tau2`   | Ï„Â² (between-study variance) |
| `print.pval.Q` | Qê²€ì • p-value               |

------------------------------------------------------------------------

## R ì‹¤ìŠµ ì˜ˆì œ - Forest plot ì˜µì…˜ ë³€í™” (8)

### ì´ì§ˆì„± í†µê³„ëŸ‰ í‘œì‹œ ì¡°ì •

![](images/clipboard-986804494.png){fig-align="center" width="100%"}

## R ì‹¤ìŠµ ì˜ˆì œ - Forest plot ì˜µì…˜ ë³€í™” (9)

### ìƒ‰ìƒ ë³€ê²½

ë‹¤ì´ì•„ëª¬ë“œì™€ ì‚¬ê°í˜•ì˜ ìƒ‰ìƒì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```{r}
#| echo: true
#| eval: false
forest(m_smd,
       common = FALSE,
       text.random = "Overall Effect",
       prediction = TRUE,
       xlim = c(-2, 2),
       at = c(-2, -1, 0, 1, 2),
       label.left = "Favours Control",
       label.right = "Favours CO2",
       digits = 2,
       digits.pval = 3,
       print.I2 = TRUE,
       print.tau2 = TRUE,
       print.pval.Q = TRUE,
       col.diamond = "steelblue",
       col.predict = "darkgray")
```

| ì˜µì…˜                 | ì„¤ëª…                     |
|----------------------|--------------------------|
| `col.diamond`        | ìš”ì•½ ë‹¤ì´ì•„ëª¬ë“œ ìƒ‰ìƒ     |
| `col.diamond.random` | ëœë¤íš¨ê³¼ ë‹¤ì´ì•„ëª¬ë“œ ìƒ‰ìƒ |
| `col.diamond.common` | ê³ ì •íš¨ê³¼ ë‹¤ì´ì•„ëª¬ë“œ ìƒ‰ìƒ |
| `col.square`         | ê°œë³„ ì—°êµ¬ ì‚¬ê°í˜• ìƒ‰ìƒ    |
| `col.predict`        | ì˜ˆì¸¡êµ¬ê°„ ìƒ‰ìƒ            |

------------------------------------------------------------------------

## R ì‹¤ìŠµ ì˜ˆì œ - Forest plot ì˜µì…˜ ë³€í™” (9)

### ìƒ‰ìƒ ë³€ê²½

![](images/clipboard-2111339296.png){fig-align="center" width="100%"}

## R ì‹¤ìŠµ ì˜ˆì œ - Forest plot ì˜µì…˜ ë³€í™” (10)

### í‘œì‹œí•  ì—´(Column) ì„ íƒ

`leftcols`, `rightcols`ë¡œ í‘œì‹œí•  ì •ë³´ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.

```{r}
#| echo: true
#| eval: false
forest(m_smd,
       common = FALSE,
       text.random = "Overall Effect",
       prediction = TRUE,
       xlim = c(-2, 2),
       at = c(-2, -1, 0, 1, 2),
       label.left = "Favours Control",
       label.right = "Favours CO2",
       digits = 2,
       col.diamond = "steelblue",
       col.predict = "darkgray",
       leftcols = c("studlab", "n.e", "n.c"),
       rightcols = c("effect", "ci", "w.random"))
```

-   `leftcols`: ê·¸ë˜í”„ ì™¼ìª½ì— í‘œì‹œí•  ì—´
-   `rightcols`: ê·¸ë˜í”„ ì˜¤ë¥¸ìª½ì— í‘œì‹œí•  ì—´

------------------------------------------------------------------------

## R ì‹¤ìŠµ ì˜ˆì œ - Forest plot ì˜µì…˜ ë³€í™” (10)

### í‘œì‹œí•  ì—´(Column) ì„ íƒ

![](images/clipboard-627326277.png){fig-align="center" width="100%"}

## R ì‹¤ìŠµ ì˜ˆì œ - Forest plot ì˜µì…˜ ë³€í™” (11)

### ì—´ ë¼ë²¨ ë³€ê²½

`leftlabs`, `rightlabs`ë¡œ ì—´ ì œëª©ì„ ë³€ê²½í•©ë‹ˆë‹¤.

```{r}
#| echo: true
#| eval: false
forest(m_smd,
       common = FALSE,
       text.random = "Overall Effect",
       prediction = TRUE,
       xlim = c(-2, 2),
       at = c(-2, -1, 0, 1, 2),
       label.left = "Favours Control",
       label.right = "Favours CO2",
       digits = 2,
       col.diamond = "steelblue",
       col.predict = "darkgray",
       leftcols = c("studlab", "n.e", "n.c"),
       leftlabs = c("Study", "N(Exp)", "N(Ctrl)"),
       rightcols = c("effect", "ci", "w.random"),
       rightlabs = c("SMD", "95% CI", "Weight(%)"))
```

------------------------------------------------------------------------

## R ì‹¤ìŠµ ì˜ˆì œ - Forest plot ì˜µì…˜ ë³€í™” (11)

### ì—´ ë¼ë²¨ ë³€ê²½

![](images/clipboard-1287873953.png){fig-align="center" width="100%"}

## R ì‹¤ìŠµ ì˜ˆì œ - Forest plot ì˜µì…˜ ë³€í™” (12)

### ì •ë ¬ ìˆœì„œ ë³€ê²½

`sortvar`ë¡œ ì—°êµ¬ í‘œì‹œ ìˆœì„œë¥¼ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```{r}
#| echo: true
#| eval: false
forest(m_smd,
       common = FALSE,
       text.random = "Overall Effect",
       prediction = TRUE,
       xlim = c(-2, 2),
       at = c(-2, -1, 0, 1, 2),
       label.left = "Favours Control",
       label.right = "Favours CO2",
       digits = 2,
       col.diamond = "steelblue",
       col.predict = "darkgray",
       leftcols = c("studlab", "n.e", "n.c"),
       leftlabs = c("Study", "N(Exp)", "N(Ctrl)"),
       rightcols = c("effect", "ci", "w.random"),
       rightlabs = c("SMD", "95% CI", "Weight(%)"),
       sortvar = TE)
```

## R ì‹¤ìŠµ ì˜ˆì œ - Forest plot ì˜µì…˜ ë³€í™” (12)

### ì •ë ¬ ìˆœì„œ ë³€ê²½

| sortvar ê°’ | ì •ë ¬ ê¸°ì¤€             |
|------------|-----------------------|
| `TE`       | íš¨ê³¼í¬ê¸° ìˆœ           |
| `-TE`      | íš¨ê³¼í¬ê¸° ì—­ìˆœ         |
| `seTE`     | í‘œì¤€ì˜¤ì°¨ ìˆœ           |
| `year`     | ì—°ë„ìˆœ (ë³€ìˆ˜ ìˆì„ ë•Œ) |

------------------------------------------------------------------------

## R ì‹¤ìŠµ ì˜ˆì œ - Forest plot ì˜µì…˜ ë³€í™” (12)

### ì •ë ¬ ìˆœì„œ ë³€ê²½

![](images/clipboard-2254817901.png){fig-align="center" width="100%"}

------------------------------------------------------------------------

## Subgroup ë¶„ì„

íŠ¹ì • ë³€ìˆ˜ì— ë”°ë¼ íš¨ê³¼ê°€ ë‹¤ë¥¸ì§€ í™•ì¸

```{r}
#| echo: true
#| eval: false

m_sub <- metacont(
  n.e = n.elev, mean.e = mean.elev, sd.e = sd.elev,
  n.c = n.amb, mean.c = mean.amb, sd.c = sd.amb,
  studlab = papno,
  data = woodyplants,
  sm = "SMD",
  random = TRUE,
  common = FALSE,
  subgroup = treat    # subgroup ë³€ìˆ˜ ì§€ì •
)
```

------------------------------------------------------------------------

## Subgroup Forest Plot

```{r}
#| echo: true
#| eval: false

forest(m_sub,
       subgroup = TRUE,
       print.subgroup.labels = TRUE)
```

## Subgroup Forest Plot

![](images/clipboard-843260697.png){fig-align="center" width="100%"}

------------------------------------------------------------------------

## Subgroup Forest Plot ì˜µì…˜

| ì˜µì…˜                    | ì„¤ëª…                   | ì˜ˆì‹œ         |
|:------------------------|:-----------------------|:-------------|
| `subgroup`              | subgroupë³„ í‘œì‹œ        | TRUE / FALSE |
| `print.subgroup.labels` | subgroup ë¼ë²¨ í‘œì‹œ     | TRUE / FALSE |
| `subgroup.hetstat`      | subgroupë³„ ì´ì§ˆì„± í‘œì‹œ | TRUE / FALSE |
| `test.subgroup`         | subgroup ê°„ ì°¨ì´ ê²€ì •  | TRUE / FALSE |
| `col.subgroup`          | subgroup ë¼ë²¨ ìƒ‰ìƒ     | "blue"       |

------------------------------------------------------------------------

## íŠ¹ì • Subgroupë§Œ ì„ íƒ

```{r}
#| echo: true
#| eval: false

# íŠ¹ì • treatë§Œ ë¶„ì„
m_subset <- metacont(
  n.e = n.elev, mean.e = mean.elev, sd.e = sd.elev,
  n.c = n.amb, mean.c = mean.amb, sd.c = sd.amb,
  studlab = papno,
  data = woodyplants,
  sm = "SMD",
  subset = treat %in% c("temp", "light"),
  subgroup = treat
)

forest(m_subset)
```

## íŠ¹ì • Subgroupë§Œ ì„ íƒ

![](images/clipboard-4110964433.png){fig-align="center" width="100%"}

------------------------------------------------------------------------

## Subgroup ê²°ê³¼ë§Œ ë³´ê¸°

```{r}
#| echo: true
#| eval: false

# subgroupë³„ ìš”ì•½ë§Œ ì¶œë ¥
summary(m_subset)
```

**í™•ì¸í•  ê²ƒ**:

-   ê° subgroupì˜ ìš”ì•½ íš¨ê³¼í¬ê¸°
-   subgroup ê°„ ì´ì§ˆì„± (between-group heterogeneity)

------------------------------------------------------------------------

## Funnel Plot ì‹¤ìŠµ ë°ì´í„°

```{r}
#| echo: true
#| eval: true
#| results: hide

pubbias_data <- data.frame(
  study = paste("Study", 1:15),
  n.e = c(120, 85, 90, 150, 45, 60, 200, 35, 75, 100, 40, 55, 180, 65, 95),
  mean.e = c(52, 48, 55, 51, 62, 58, 50, 68, 54, 53, 65, 59, 49, 56, 52),
  sd.e = c(12, 15, 14, 11, 18, 16, 10, 20, 14, 13, 19, 17, 11, 15, 13),
  n.c = c(118, 82, 88, 148, 47, 62, 198, 33, 73, 102, 42, 58, 178, 63, 93),
  mean.c = c(48, 46, 50, 48, 52, 50, 48, 55, 49, 49, 53, 51, 47, 50, 48),
  sd.c = c(13, 14, 15, 12, 17, 15, 11, 19, 13, 14, 18, 16, 10, 14, 12)
)

m <- metacont(
  n.e = n.e, mean.e = mean.e, sd.e = sd.e,
  n.c = n.c, mean.c = mean.c, sd.c = sd.c,
  studlab = study,
  data = pubbias_data,
  sm = "SMD",
  random = TRUE,
  common = FALSE
)
```

------------------------------------------------------------------------

## ê¸°ë³¸ Funnel Plot

```{r}
#| echo: true
#| eval: true

funnel(m)
```

------------------------------------------------------------------------

## funnel() ì£¼ìš” ì˜µì…˜

| ì˜µì…˜             | ì„¤ëª…        | ì˜ˆì‹œ                            |
|:-----------------|:------------|:--------------------------------|
| `studlab`        | ì—°êµ¬ëª… í‘œì‹œ | TRUE / FALSE                    |
| `xlim`           | Xì¶• ë²”ìœ„    | c(-2, 2)                        |
| `ylim`           | Yì¶• ë²”ìœ„    | c(0, 1)                         |
| `xlab`           | Xì¶• ë¼ë²¨    | "SMD"                           |
| `ylab`           | Yì¶• ë¼ë²¨    | "Standard Error"                |
| `contour.levels` | ë“±ê³ ì„  ìˆ˜ì¤€ | c(0.9, 0.95, 0.99)              |
| `col.contour`    | ë“±ê³ ì„  ìƒ‰ìƒ | c("gray75", "gray85", "gray95") |

------------------------------------------------------------------------

## funnel() ìŠ¤íƒ€ì¼ ì˜µì…˜

| ì˜µì…˜  | ì„¤ëª…      | ì˜ˆì‹œ           |
|:------|:----------|:---------------|
| `pch` | ì  ëª¨ì–‘   | 19             |
| `col` | ì  ìƒ‰ìƒ   | "blue"         |
| `bg`  | ì  ë°°ê²½ìƒ‰ | "lightblue"    |
| `cex` | ì  í¬ê¸°   | 1.5            |
| `lwd` | ì„  ë‘ê»˜   | 2              |
| `lty` | ì„  ìŠ¤íƒ€ì¼ | 1=ì‹¤ì„ , 2=ì ì„  |

------------------------------------------------------------------------

## ì—°êµ¬ëª… í‘œì‹œ

```{r}
#| echo: true
#| eval: true

funnel(m, studlab = TRUE)
```

------------------------------------------------------------------------

## ì¶• ë²”ìœ„ ë° ë¼ë²¨ ì„¤ì •

```{r}
#| echo: true
#| eval: false

funnel(m,
       xlim = c(-2, 2),
       ylim = c(0, 0.8),
       xlab = "Standardized Mean Difference",
       ylab = "Standard Error")
```

------------------------------------------------------------------------

## ì¶• ë²”ìœ„ ë° ë¼ë²¨ ì„¤ì •

![](images/clipboard-4080650365.png){fig-align="center" width="100%"}

## Contour-Enhanced Funnel Plot

```{r}
#| echo: true
#| eval: false

funnel(m,
       contour.levels = c(0.90, 0.95, 0.99),
       col.contour = c("darkgray", "gray", "lightgray"))
```

| ì˜ì—­      | ì˜ë¯¸             |
|:----------|:-----------------|
| ì§„í•œ íšŒìƒ‰ | p \< 0.01        |
| ì¤‘ê°„ íšŒìƒ‰ | 0.01 â‰¤ p \< 0.05 |
| ì—°í•œ íšŒìƒ‰ | 0.05 â‰¤ p \< 0.10 |

------------------------------------------------------------------------

## Contour-Enhanced Funnel Plot

![](images/clipboard-1194049476.png){fig-align="center" width="100%"}

## ì /ì„  ìŠ¤íƒ€ì¼ ë³€ê²½

```{r}
#| echo: true
#| eval: false

funnel(m,
       pch = 21,             # í…Œë‘ë¦¬ ìˆëŠ” ì›
       col = "darkblue",     # í…Œë‘ë¦¬ ìƒ‰
       bg = "lightblue",     # ì±„ìš°ê¸° ìƒ‰
       cex = 1.5,            # ì  í¬ê¸°
       lwd = 2)              # ì„  ë‘ê»˜
```

**pch ê°’**: 1=ë¹ˆ ì›, 15=ì‚¬ê°í˜•, 16=ì±„ìš´ ì›, 17=ì‚¼ê°í˜•, 19=ì±„ìš´ ì›, 21=í…Œë‘ë¦¬ ì›

------------------------------------------------------------------------

## ì /ì„  ìŠ¤íƒ€ì¼ ë³€ê²½

![](images/clipboard-2225112377.png){fig-align="center" width="100%"}

## ì¢…í•© ì˜ˆì œ: ì™„ì„±ëœ Funnel Plot

```{r}
#| echo: true
#| eval: false

funnel(m,
       xlim = c(-2, 2),
       xlab = "Standardized Mean Difference",
       ylab = "Standard Error",
       contour.levels = c(0.90, 0.95, 0.99),
       col.contour = c("darkgray", "gray", "lightgray"),
       pch = 19,
       col = "navy",
       cex = 1.2,
       lwd = 2,
       studlab = TRUE,
       cex.studlab = 0.8)
```

------------------------------------------------------------------------

## ì¢…í•© ì˜ˆì œ: ì™„ì„±ëœ Funnel Plot

![](images/clipboard-3345704999.png){fig-align="center" width="100%"}

## Egger's Test

```{r}
#| echo: true
#| eval: true
metabias(m, method.bias = "Egger")
```

**í•´ì„**:

-   p \< 0.10 â†’ ë¹„ëŒ€ì¹­ì„± ìˆìŒ (ì¶œíŒ í¸í–¥ ì˜ì‹¬)
-   p â‰¥ 0.10 â†’ ë¹„ëŒ€ì¹­ì„± ì¦ê±° ì—†ìŒ

------------------------------------------------------------------------

## method.bias ì˜µì…˜

| ì˜µì…˜                       | ì„¤ëª…                    |
|:---------------------------|:------------------------|
| `method.bias = "Egger"`    | Egger's regression test |
| `method.bias = "Begg"`     | Begg's rank correlation |
| `method.bias = "Thompson"` | Thompson-Sharp test     |
| `plotit = TRUE`            | ì‹œê°í™”                  |

------------------------------------------------------------------------

## Trim and Fill

```{r}
#| echo: true
#| eval: true
#| results: hide

# Trim and fill ë¶„ì„
tf <- trimfill(m)

# ê²°ê³¼ í™•ì¸
summary(tf)
```

-   `k0`: ì¶”ì •ëœ ëˆ„ë½ ì—°êµ¬ ìˆ˜
-   ë³´ì •ëœ ìš”ì•½ íš¨ê³¼í¬ê¸° í™•ì¸

------------------------------------------------------------------------

## Trim and Fill

```         
                     SMD            95%-CI %W(random)
Study 1           0.3188 [ 0.0631; 0.5746]        7.3
Study 2           0.1371 [-0.1666; 0.4409]        5.2
Study 3           0.3433 [ 0.0473; 0.6393]        5.5
Study 4           0.2600 [ 0.0320; 0.4881]        9.2
Study 5           0.5668 [ 0.1495; 0.9840]        2.8
Study 6           0.5129 [ 0.1520; 0.8738]        3.7
Study 7           0.1899 [-0.0070; 0.3869]       12.4
Study 8           0.6583 [ 0.1693; 1.1473]        2.0
Study 9           0.3680 [ 0.0430; 0.6931]        4.6
Study 10          0.2949 [ 0.0175; 0.5722]        6.2
Study 11          0.6427 [ 0.1982; 1.0873]        2.4
Study 12          0.4817 [ 0.1074; 0.8561]        3.4
Study 13          0.1898 [-0.0178; 0.3975]       11.1
Study 14          0.4109 [ 0.0606; 0.7611]        3.9
Study 15          0.3183 [ 0.0306; 0.6061]        5.8
Filled: Study 12  0.0449 [-0.3294; 0.4193]        3.4
Filled: Study 6   0.0138 [-0.3471; 0.3747]        3.7
Filled: Study 5  -0.0401 [-0.4574; 0.3771]        2.8
Filled: Study 11 -0.1161 [-0.5606; 0.3285]        2.4
Filled: Study 8  -0.1317 [-0.6207; 0.3573]        2.0

Number of studies: k = 20 (with 5 added studies)
Number of observations: o = 3257 (o.e = 1630, o.c = 1627)

                        SMD           95%-CI    z  p-value
Random effects model 0.2633 [0.1940; 0.3327] 7.44 < 0.0001

Quantifying heterogeneity (with 95%-CIs):
 tau^2 < 0.0001 [0.0000; 0.0736]; tau = 0.0020 [0.0000; 0.2713]
 I^2 = 22.0% [0.0%; 54.7%]; H = 1.13 [1.00; 1.49]

Test of heterogeneity:
     Q d.f. p-value
 24.37   19  0.1823

Details of meta-analysis methods:
- Inverse variance method
- Restricted maximum-likelihood estimator for tau^2
- Q-Profile method for confidence interval of tau^2 and tau
- Calculation of I^2 based on Q
- Trim-and-fill method to adjust for funnel plot asymmetry (L-estimator)
```

## Trim and Fill Funnel Plot

```{r}
#| echo: true
#| eval: true

funnel(tf)
```

-   í° ì›(â—‹): ì›ë˜ ì—°êµ¬
-   ê²€ì€ ì›(â—): ì¶”ì •ëœ ëˆ„ë½ ì—°êµ¬

------------------------------------------------------------------------

## Trim and Fill ì˜µì…˜

```{r}
#| echo: true
#| eval: false

# ì™¼ìª½ë§Œ ì±„ìš°ê¸°
tf_left <- trimfill(m, left = TRUE)

# ì˜¤ë¥¸ìª½ë§Œ ì±„ìš°ê¸°  
tf_right <- trimfill(m, left = FALSE)

# ê²°ê³¼ ë¹„êµ
summary(tf_left)
summary(tf_right)
```

------------------------------------------------------------------------

## ë³´ì • ì „í›„ ë¹„êµ

```{r}
#| echo: true
#| eval: false

# ì›ë˜ ê²°ê³¼
summary(m)

# ë³´ì • í›„ ê²°ê³¼
summary(tf)

# íš¨ê³¼í¬ê¸° ë¹„êµ
cat("ì›ë˜:", m$TE.random, "\n")
cat("ë³´ì •:", tf$TE.random, "\n")
```

```         
ì›ë˜: 0.3126432 
ë³´ì •: 0.2633364 
```

------------------------------------------------------------------------

## Executive summary

**ë™ì¼í•œ ê²°ê³¼ì§€í‘œë¥¼ ê°€ì§„ ì—°êµ¬ë“¤ì„ í•©ì¹œë‹¤**

-   Mean, proportion: ê·¸ë£¹ 1ê°œ

-   Ratio(RR, OR, ROM), difference(MD, SMD): ê·¸ë£¹ 2ê°œ ë¹„êµ

-   ê·¸ë£¹ë³„ **Mean(sd) ë˜ëŠ” Event/N ê°’ì´ í•„ìš”**, Measure(95%CI) ë§Œ ìˆì–´ë„ ê°€ëŠ¥.

**Inversed variance: Fixed effect vs Random effect**

-   ë¶„ì‚°ì´ ì‘ì€ ì—°êµ¬ì— ê°€ì¤‘ì¹˜ë¥¼ ì£¼ì§€ë§Œ, í•œ ì—°êµ¬ì˜ ì˜í–¥ë ¥ì´ ë„ˆë¬´ ì»¤ì§€ëŠ”ê±´ ì‹«ë‹¤.

**`Forestplot` ìœ¼ë¡œ í‘œì‹œí•œë‹¤**

-   ê²€ì¦ìœ„í•´ `funnel plot`, heterogeneity ì§€í‘œ í•„ìš”

[openstat.ai](https://openstat.ai) ì—ì„œ ë©”íƒ€ë¶„ì„ ìˆ˜í–‰ ê°€ëŠ¥

-   R [meta](https://doing-meta.guide/) íŒ¨í‚¤ì§€ë¡œë„ êµ¬í˜„ê°€ëŠ¥

# ê°ì‚¬í•©ë‹ˆë‹¤.
